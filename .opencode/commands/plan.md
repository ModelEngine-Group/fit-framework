---
description: 为任务设计技术方案并输出实施计划
agent: general
subtask: false
---

为任务 $1 设计技术方案。

执行以下步骤:

1. 查找任务文件:
   - 在 .ai-workspace/active/$1/task.md 查找
   - 如果不存在,检查 blocked/ 和 completed/ 目录
   - 读取 task.md 和 analysis.md

2. 设计技术方案:
   - 设计技术实现方案
   - 选择合适的技术栈和设计模式
   - 制定详细的实施步骤
   - 列出需要创建/修改的文件清单
   - 设计测试策略
   - 评估性能和安全影响

3. 输出方案文档到 plan.md,包含:
   - 方案决策(方案对比分析和最终选择)
   - 技术方案(核心实现策略和关键技术点)
   - 实施步骤(详细的步骤列表)
   - 文件清单(需要创建和修改的文件)
   - 测试策略(单元测试和集成测试)
   - 性能考虑
   - 安全考虑
   - 回滚方案
   - 风险控制
   - 预期产出

4. 更新任务状态:
   - current_step: technical-design
   - updated_at: 当前时间
   - 在工作流进度中标记技术方案设计为完成

5. 告知用户:
   - 输出方案概要(最终方案、工作量、风险等级)
   - 显示输出文件路径
   - **提示这是人工审查检查点,需要审查后才能继续**
   - 审查通过后使用 /implement $1 开始实施

**注意事项**:
- 必须先完成需求分析(analysis.md 存在)
- 这是一个**必须**的人工检查点,方案设计完成后等待人工审查
- 充分思考,考虑多个方案并对比
- 确保所有必需章节都包含
