description = "ä» PR/commit ä¸­è‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–çš„ Release Notesï¼Œå¹¶å¯é€‰åˆ›å»º GitHub Draft Release"
prompt = """
è¯·ä¸ºç‰ˆæœ¬ {{args}} ç”Ÿæˆ Release Notesã€‚

è‡ªåŠ¨ä» PRã€commit å’Œ Issue ä¸­æ”¶é›†å˜æ›´ä¿¡æ¯ï¼ŒæŒ‰æ¨¡å—å’Œç±»å‹åˆ†ç±»ï¼Œç”Ÿæˆç¬¦åˆé¡¹ç›®æ ¼å¼çš„ Release Notesã€‚æ”¯æŒåˆ›å»º GitHub Draft Releaseã€‚å¯¹äº x.y.0 ç‰ˆæœ¬ï¼Œæ”¯æŒåˆå¹¶å‰ä¸€ minor ç³»åˆ—çš„å·²å‘å¸ƒ release notesã€‚

**å½“å‰çŠ¶æ€**:
!{git tag --sort=-v:refname | head -10}
!{git branch --show-current}

æ­¥éª¤ 1-3 ä¸ºå…¬å…±æ­¥éª¤ï¼Œæ­¥éª¤ 3 æ ¹æ®ç‰ˆæœ¬ç±»å‹åˆ†æµ:
- **åˆå¹¶è·¯å¾„**ï¼ˆPATCH == 0ï¼‰: æ­¥éª¤ 4-7 â†’ è·³åˆ°æ­¥éª¤ 14
- **å¸¸è§„è·¯å¾„**ï¼ˆPATCH > 0ï¼‰: æ­¥éª¤ 8-13 â†’ ç»§ç»­æ­¥éª¤ 14
æ­¥éª¤ 14-15 ä¸ºå…¬å…±æ­¥éª¤ã€‚

æ‰§è¡Œä»¥ä¸‹æ­¥éª¤:

1. **è§£æå‚æ•°**:
   - ä» {{args}} ä¸­æå–å‚æ•°ï¼Œæ”¯æŒä¸¤ç§å½¢å¼:
     - å•å‚æ•°: `<version>` â€” å½“å‰ç‰ˆæœ¬å·
     - åŒå‚æ•°: `<version> <prev-version>` â€” å½“å‰ç‰ˆæœ¬å·å’Œä¸Šä¸€ç‰ˆæœ¬å·
   - ç‰ˆæœ¬å·å¿…é¡»åŒ¹é… `X.Y.Z` æ ¼å¼ï¼ˆXã€Yã€Z å‡ä¸ºéè´Ÿæ•´æ•°ï¼‰
   - å¦‚æœæ ¼å¼ä¸æ­£ç¡®ï¼ŒæŠ¥é”™é€€å‡ºï¼š`é”™è¯¯ï¼šç‰ˆæœ¬å·æ ¼å¼ä¸æ­£ç¡®ï¼ŒæœŸæœ›æ ¼å¼ä¸º X.Y.Zï¼ˆä¾‹å¦‚ 3.6.3ï¼‰`

2. **ç¡®å®šç‰ˆæœ¬èŒƒå›´**:
   - å½“å‰ç‰ˆæœ¬ tag: `v<version>`
   - ä¸Šä¸€ç‰ˆæœ¬ tag æ¨æ–­é€»è¾‘ï¼ˆä»…å½“æœªæŒ‡å®š `<prev-version>` æ—¶ï¼‰:
     - ä½¿ç”¨ `run_shell_command` æ‰§è¡Œ: `git tag --sort=-v:refname`
     - å¦‚æœ PATCH > 0: æŸ¥æ‰¾åŒä¸€ minor ç³»åˆ—ä¸­çš„å‰ä¸€ä¸ª tag
     - å¦‚æœ PATCH == 0: æŸ¥æ‰¾å‰ä¸€ä¸ª minor ç³»åˆ—çš„æœ€åä¸€ä¸ª tag
   - éªŒè¯ tag å­˜åœ¨: `git rev-parse v<version>` å’Œ `git rev-parse v<prev-version>`

3. **åˆ¤æ–­ç‰ˆæœ¬ç±»å‹å¹¶é€‰æ‹©è·¯å¾„**:
   - å¦‚æœ PATCH == 0 â†’ èµ°**åˆå¹¶è·¯å¾„**ï¼Œä»æ­¥éª¤ 4 å¼€å§‹
   - å¦‚æœ PATCH > 0 â†’ èµ°**å¸¸è§„è·¯å¾„**ï¼Œä»æ­¥éª¤ 8 å¼€å§‹

--- åˆå¹¶è·¯å¾„ï¼ˆPATCH == 0ï¼Œx.y.0 ç‰ˆæœ¬ï¼‰---

4. **æŸ¥æ‰¾å‰ä¸€ minor ç³»åˆ—çš„æ‰€æœ‰å·²å‘å¸ƒ release**:
   - ä½¿ç”¨ `run_shell_command` æ‰§è¡Œ: `gh release list --limit 50 --json tagName,isDraft,isPrerelease`
   - ç­›é€‰ tagName ä»¥ `vX.(Y-1).` å¼€å¤´ã€isDraft==falseã€isPrerelease==false çš„æ¡ç›®
   - å¦‚æœæœªæ‰¾åˆ°ä»»ä½•å·²å‘å¸ƒçš„ releaseï¼Œæç¤ºç”¨æˆ·å¹¶å›é€€åˆ°å¸¸è§„è·¯å¾„ï¼ˆæ­¥éª¤ 8ï¼‰

5. **æŒ‰ç‰ˆæœ¬å·å‡åºè·å–å„ release body**:
   - å¯¹æ¯ä¸ª release tag æ‰§è¡Œ: `gh release view v<tag> --json body --jq .body`

6. **åˆå¹¶æ‰€æœ‰ release body**:
   - æŒ‰ç‰ˆæœ¬é¡ºåºæ‹¼æ¥å„ç‰ˆæœ¬çš„å®Œæ•´ release notes
   - åŒå¹³å°åŒç±»å‹æ¡ç›®åˆå¹¶ï¼ˆå¦‚ FIT Function Platform çš„ Enhancement æ¡ç›®åˆå¹¶åˆ°ä¸€èµ·ï¼‰
   - å»é‡ Contributorsï¼ˆåˆå¹¶æ‰€æœ‰ â¤ï¸ Contributors æ®µè½ï¼Œå»é‡åæŒ‰è´¡çŒ®é‡é™åºæ’åˆ—ï¼‰

7. **ç”Ÿæˆ Overview**:
   - x.y.0 å§‹ç»ˆè§†ä¸º Major release
   - åœ¨é¡¶éƒ¨æ·»åŠ  ğŸŒŸ Overview æ€»ç»“æ®µè½ï¼ˆ2-3 å¥è¯æ¦‚æ‹¬æ•´ä¸ª minor ç³»åˆ—çš„æ ¸å¿ƒä¸»é¢˜å’Œäº®ç‚¹ï¼‰
   - æ¯ä¸ªå¹³å°æ·»åŠ  ğŸš€ Features Overview è¦ç‚¹åˆ—è¡¨ï¼ˆ3-5 ä¸ªå…³é”®ç‰¹æ€§è¦ç‚¹ï¼‰
   - **å®Œæˆåè·³åˆ°æ­¥éª¤ 14**

--- å¸¸è§„è·¯å¾„ï¼ˆPATCH > 0ï¼‰---

8. **æ”¶é›†åˆå¹¶çš„ PR**:
   - è·å–ä¸¤ä¸ª tag ä¹‹é—´çš„æ—¥æœŸèŒƒå›´:
     - `git log v<prev-version> --format=%aI -1`
     - `git log v<version> --format=%aI -1`
   - è·å–ç›®æ ‡åˆ†æ”¯ï¼ˆåˆ†æ”¯åæ ¼å¼: X.Y.xï¼‰
   - ä½¿ç”¨ `run_shell_command` æ‰§è¡Œ: `gh pr list --state merged --base <branch> --json number,title,body,author,labels,mergedAt,url --limit 200 --search "merged:YYYY-MM-DD..YYYY-MM-DD"`
   - è¡¥å……: `git log v<prev-version>..v<version> --format="%H %s" --no-merges`
   - æ‰¾å‡ºæ²¡æœ‰å…³è” PR çš„ commit

9. **æ”¶é›†å…³è”çš„ Issue**:
   - ä» PR body ä¸­æå–: `Closes #N`ã€`Fixes #N`ã€`Resolves #N`ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
   - ä½¿ç”¨ `run_shell_command` æ‰§è¡Œ: `gh issue view <N> --json number,title,labels,url`

10. **åˆ†ç±» â€” æŒ‰æ¨¡å—åˆ†ç»„**:
    æŒ‰ä¼˜å…ˆçº§åˆ¤æ–­æ¨¡å—:
    - PR title ä¸­çš„æ¨¡å—æ ‡ç­¾ `[fit]`, `[FEL]`, `[waterflow]`
    - Conventional commit scope `feat(fit):`, `fix(waterflow):`
    - PR å˜æ›´æ–‡ä»¶è·¯å¾„ï¼ˆ`gh pr view <N> --json files`ï¼‰
    - é»˜è®¤å½’å…¥ FIT Function Platform

    æ¨¡å—åˆ°å¹³å°çš„æ˜ å°„:
    - fit/python/docker/fit-launcher/framework/fit/** â†’ FIT Function Platform
    - fel/FEL/framework/fel/** â†’ FIT Expression for LLM
    - waterflow/framework/waterflow/** â†’ Waterflow Flow Scheduling Platform
    - claude/.claude/.ai-agents/AI ç›¸å…³ â†’ ğŸ¤– AI Development Configuration

11. **åˆ†ç±» â€” æŒ‰ç±»å‹åˆ†ç»„**:
    - feat/perf/refactor/chore(deps)/ä¾èµ–å‡çº§ â†’ âœ¨ Enhancement
    - fix â†’ âœ… Bugfix
    - docs â†’ ğŸ“š Documentationï¼ˆæ¡ç›®å°‘äº 3 ä¸ªåˆ™å¹¶å…¥ Enhancementï¼‰

12. **åˆ¤æ–­å‘å¸ƒçº§åˆ«**:
    - Major releaseï¼ˆåˆå¹¶ PR > 15 ä¸ªï¼‰: ç”Ÿæˆ ğŸŒŸ Overview + æ¯ä¸ªå¹³å° ğŸš€ Features Overview
    - Regular release: ç›´æ¥åˆ—å‡ºæ¡ç›®ï¼Œä¸åŠ  Overview

13. **ç”Ÿæˆ Release Notes**:
    æŒ‰é¡¹ç›®æ ¼å¼è¾“å‡º markdown:
    ```
    ## FIT Function Platform
    ### âœ¨ Enhancement
    - [fit] æè¿° by @author in [#N](url)
    ### âœ… Bugfix
    - [fit] æè¿° by @author in [#N](url)
    ## â¤ï¸ Contributors
    @contributor1, @contributor2
    ```
    æ ¼å¼è§„åˆ™:
    - æ¡ç›®æ ¼å¼: `- [module] æè¿° by @author1 and @author2 in [#N](url)`
    - å…³è” Issue å’Œ PR: `in [#Issue](issue-url) and [#PR](pr-url)`
    - æè¿°ä¼˜å…ˆä½¿ç”¨ PR titleï¼Œå»æ‰ type(scope): å‰ç¼€ï¼Œé¦–å­—æ¯å¤§å†™
    - è´¡çŒ®è€…å»é‡ï¼ŒæŒ‰è´¡çŒ®é‡é™åºæ’åˆ—
    - ç©ºå¹³å°ä¸è¾“å‡º

--- å…¬å…±æ­¥éª¤ ---

14. **å±•ç¤ºå¹¶ç¡®è®¤**:
    å°† release notes å®Œæ•´è¾“å‡ºç»™ç”¨æˆ·æŸ¥çœ‹ï¼Œè¯¢é—®:
    - æ˜¯å¦éœ€è¦è°ƒæ•´å†…å®¹
    - æ˜¯å¦åˆ›å»º GitHub Draft Release

15. **åˆ›å»º Draft Release**:
    ç”¨æˆ·ç¡®è®¤åæ‰§è¡Œ:
    `gh release create v<version> --title "v<version>" --notes-file /tmp/release-notes-v<version>.md --target <release-branch-or-tag> --draft`

**é”™è¯¯å¤„ç†**:
- ç‰ˆæœ¬å·æ ¼å¼é”™è¯¯ â†’ æç¤ºæ­£ç¡®æ ¼å¼å¹¶é€€å‡º
- Tag ä¸å­˜åœ¨ â†’ æç¤ºç¡®è®¤ tag å·²åˆ›å»º
- gh CLI æœªå®‰è£…æˆ–æœªè®¤è¯ â†’ æç¤ºå®‰è£…/è®¤è¯æ–¹æ³•
- æ— åˆå¹¶ PR â†’ æç¤ºæ£€æŸ¥ tag å’Œåˆ†æ”¯
- x.y.0 æ— å·²å‘å¸ƒ release â†’ å›é€€åˆ°å¸¸è§„è·¯å¾„
"""
